<%
    function formatSize(size) {
        if (!size) return '---';
        if (size < 1024) return size + 'B';
        if (size < 1024 * 1024) return (size / 1024).toFixed(2) + 'KB';
        return (size / (1024 * 1024)).toFixed(2) + 'MB';
    }
%>
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>管理页面</title>
    <script src="/jquery.min.js" type="text/javascript"></script>
    <style type="text/css">
        body {
            padding: 0 5px;
        }
        body > div {
            line-height: 1.5;
        }
        a {
            color: #0e90d2;
            text-decoration: none;
            transition: all linear .3s 0s;
        }
        a:hover {
            color: #095f8a;
            text-decoration: underline;
        }
        th, td {
            min-width: 160px;
            text-align: center;
        }
        a.entry {
            display: block;
        }
        .e-none {
            color: lightgray;
        }
    </style>
</head>
<body>
    <h3>管理页面</h3>
    <hr>
    <table rules="all" frames="border" border="1">
        <thead>
            <tr>
                <th>选手</th>
                <% options.problems.forEach(function(name) {%>
                <th><%= name %></th>
                <% }) %>
            </tr>
        </thead>
        <tbody>
            <% users.forEach(function(user) { %>
            <tr>
                <td><%= user.username %></td>
                <% options.problems.forEach(function(name) {%>
                <td>
                    <% var entry = user.findSubmitted(name); %>
                    <% if (entry) { %>
                    <a class="entry" href="/admin/code/<%- user.username %>/<%- name %>" target="_blank">
                        <span><%= entry.language %>, <%= formatSize(entry.size) %></span>
                    </a>
                    <% } else { %>
                    <span class="e-none">未提交</span>
                    <% } %>
                </td>
                <% }) %>
            </tr>
            <% }) %>
        </tbody>
    </table>
    <div>
        <a href="/admin/logout">退出</a>
    </div>
</body>
</html>